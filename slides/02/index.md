---
marp: true
paginate: true
theme: press
---

<!-- _class: cover -->

<h1 class="logo"><b>CODE</b>_ARCHITECT #2</h1>
<p class="title">コード・アーキテクト :: アプリ設計・開発手法 #2</p>
<p class="author">&copy; 2025 Satoshi Soma</p>

---

# ローカルでスケッチを動かす

---

まずは前回デスクトップに作成した `📁 HelloP5` にターミナルで移動しよう。

```sh
% cd ~/Desktop/HelloP5
```

この記号 *`~`* は「*ティルダ<small>（またはチルダ）</small>*」と呼び、ターミナルにおいては特別な意味がある。
**`~` で始まるファイルパスは必ず自分のホームディレクトリを基準としたパスとして解釈される**のだ。
つまり、上記のコマンドは以下のコマンドと同じ意味を持つ。<small>（macOS の場合）</small>

```sh
% cd /Users/自分のユーザー名/Desktop/HelloP5
```

<small class="note"><kbd>Tab</kbd> キーでパスの補完が出来ることも忘れずに。</small>

---

次に CODE_ARCHITECT に付属している `📁 files/p5_template` フォルダ内の*全ファイル*を、
`📁 HelloP5` フォルダ内にコピーしてほしい。

ファイルのコピーは *`cp コピー元 コピー先`* というコマンドで行える。 
また、**フォルダ内の全ファイルをまとめてコピー**したい場合は、

```sh
% cp コピー元ディレクトリ/* コピー先ディレクトリ/
```

このように *`*` 記号*を用いる。

---

## ローカルサーバー
スケッチ内で画像や音声素材などのファイルが使用されている場合、
残念ながら **`index.html` を直接ブラウザで開くだけでは正しく動作しない**。

通常、ブラウザでウェブサイトにアクセスする際の URL は `http://` または `https://` で始まるものになる。この部分を「**プロトコル (Protocol)**」と呼ぶのだが、
ローカルの HTML ファイルを直接ブラウザで開く場合は **`file://`** というプロトコルを使用することになる。この `file://` プロトコルにはセキュリティ上の理由で*機能制限*が掛かっており、
*スケッチからローカルにあるファイルを読み込むことができない*のだ。

ローカルでスケッチを正しく動作させるためには `file://` プロトコルを避け、
通常のウェブサイトと同様、`http://` プロトコルを使用しなければならない。
そのために必要になるのが**ローカルサーバー**だ。

---

単に「サーバー」というと大抵はサーバーマシンのことを指すものだが、
ここでは*サーバーソフトウェア*のことだと理解してほしい。

サーバーソフトの役割は、ユーザーからのアクセス要求（**リクエスト**）を受け取り、
その要求に対する適切な情報<small>（HTML ファイルなど）</small>をユーザーに提供 (Serve) することだ。

インターネットに繋がれたリモートマシンがサーバーソフトを稼働させることで、
世のウェブサイトやウェブアプリは機能している。

---

ウェブサイト, ウェブアプリの開発者は、**自分のコンピュータ（ローカルマシン）上でサーバーソフトを稼働**させ、ブラウザで動作確認を行いながら開発を進める。

サーバーソフトは一つでは無いが、
当講義では **[Browsersync<small>（ブラウザシンク）</small>](https://browsersync.io/)** をローカルサーバーとして利用することとする。

---

## NPM
Browsersync のインストールは、前回インストールした Node.js に付属している、
**NPM <small>(Node Package Manager)</small>** を介して行う。

NPM は*パッケージ管理ソフト*の一つで、Homebrew と用途は似ている。
ただし NPM が管理する対象は JavaScript 製のアプリやライブラリが主となる。

NPM でアプリをインストールするには以下のコマンドを実行すればよい。

```sh
% npm i -g アプリ名
```

アプリは [www.npmjs.com](https://www.npmjs.com/) で探すことができる。

---

Browsersync は以下のコマンドでインストールできる。

```sh
% npm i -g browser-sync
```

インストールが成功すれば *`browser-sync`* コマンドが使用可能になる。

実際にローカルサーバーを起動するには、

1. `cd` コマンドで **`index.html` のあるディレクトリ**に移動し、
2. 以下のコマンドを実行する。
```sh
% browser-sync start -s
```

---

ローカルサーバーが起動すると以下のような情報が表示される。

```sh
[Browsersync] Access URLs:
 ------------------------------------
       Local: http://localhost:3000
    External: http://xxx.xx.xx.x:3000
 ------------------------------------
          UI: http://localhost:3001
 UI External: http://xxx.xx.xx.x:3001
 ------------------------------------
[Browsersync] Serving files from: ./
```

`Local:` の右に示されている URL にブラウザでアクセスすれば実際に動作確認を行うことができる。
*`localhost`* というのは、**このサーバーを動かしているマシンそのもの**のことを指す。
`:3000` の部分は*ポート番号*を示しているが、ここでの解説は割愛させていただく。

`External:` の右に示されている URL を使用すれば、他の PC やスマホから動作確認を行うこともできる。ただし、同じネットワーク内のデバイスからのアクセスのみに限られる。

